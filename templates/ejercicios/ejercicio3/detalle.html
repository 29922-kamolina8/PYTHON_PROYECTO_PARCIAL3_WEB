{% extends "base.html" %}
{% block title %}{{ ejercicio.titulo }} ¬∑ Python Academy{% endblock %}

{% block content %}

<style>
  .hero-ej{
    background:#f8fafc;
    border-bottom:1px solid rgba(0,0,0,.08);
    padding:52px 0;
  }
  .hero-ej .badge{border-radius:999px;padding:8px 14px;font-weight:700;}
  .hero-ej h1{font-weight:800;letter-spacing:-.02em;}
  .hero-ej p{max-width:920px;margin:0 auto;}

  .hero-top-actions{display:flex;justify-content:center;margin-bottom:14px;}
  .btn-pill{border-radius:999px;padding:10px 22px;font-weight:700;}
  .btn-pill-sm{border-radius:999px;padding:8px 16px;font-weight:700;}

  .ej-wrap{padding:36px 0 70px;}
  .ej-panel{
    border-radius:18px;border:1px solid rgba(0,0,0,.08);
    box-shadow:0 10px 25px rgba(0,0,0,.05);
    background:#fff;padding:26px;
  }

  .ej-actions{
    margin-top:18px;padding-top:18px;
    border-top:1px solid rgba(0,0,0,.08);
    display:flex;justify-content:center;
  }

  .form-shell{margin-top:22px;display:flex;justify-content:center;}
  .form-card{
    width:100%;max-width:720px;
    border-radius:18px;border:1px solid rgba(0,0,0,.08);
    box-shadow:0 10px 25px rgba(0,0,0,.06);
    background:#fff;padding:22px;
  }
  .form-card *{max-width:100%;}

  .ej-nav-bottom{
    margin-top:26px;
    padding-top:18px;
    border-top:1px solid rgba(0,0,0,.08);
    display:flex;justify-content:space-between;
    gap:12px;flex-wrap:wrap;
  }
  .ej-nav-bottom .btn{min-width:170px;}

  .explain-card{
    border:1px solid rgba(0,0,0,.08);
    border-radius:16px;
    padding:18px;
    background:#fbfdff;
  }

  .code-box{
    background:#0b1220;
    color:#e6edf3;
    border-radius:14px;
    padding:14px;
    overflow:auto;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,"Courier New", monospace;
    font-size:.92rem;
    white-space:pre;
    margin:0;
  }
  .hint{font-size:.95rem;color:#556;}
</style>

<!-- HERO -->
<section class="hero-ej">
  <div class="container text-center">

    <div class="hero-top-actions">
      <a href="{{ url_for('ejercicios') }}" class="btn btn-outline-secondary btn-pill-sm">
        <i class="bi bi-arrow-left me-1"></i> Volver al men√∫
      </a>
    </div>

    <span class="badge bg-primary mb-3">{{ ejercicio.tema }}</span>
    <h1 class="display-5 mb-2">{{ ejercicio.titulo }}</h1>
    <p class="lead text-muted">{{ ejercicio.descripcion }}</p>
  </div>
</section>

<!-- CONTENIDO -->
<section class="ej-wrap">
  <div class="container">
    <div class="ej-panel">

      <!-- ENUNCIADO -->
      <div class="explain-card mb-4">
        <h4 class="fw-bold mb-2">üß© Enunciado</h4>
        <p class="mb-2">
          En este ejercicio se desarrolla un <b>programa en Flask</b> que permite
          al usuario ingresar un n√∫mero entero y calcular su <b>factorial</b>.
        </p>
        <p class="mb-0 hint">
          Objetivo: comprender c√≥mo Flask procesa formularios con <code>GET</code> y
          <code>POST</code>, valida datos y muestra resultados din√°micamente.
        </p>
      </div>

      <!-- EXPLICACI√ìN -->
      <div class="explain-card mb-4">
        <h4 class="fw-bold mb-3">üìå Explicaci√≥n del c√≥digo (paso a paso)</h4>

        <h5 class="fw-bold mb-2">0) Idea general (GET vs POST)</h5>
        <ul class="mb-3">
          <li><b>GET:</b> se muestra el formulario para ingresar el n√∫mero.</li>
          <li><b>POST:</b> el usuario presiona <b>Calcular</b> y Flask procesa el factorial.</li>
          <li>Flask identifica el m√©todo con <code>request.method</code>.</li>
        </ul>

        <h5 class="fw-bold mb-2">1) Entrada del usuario</h5>
        <p class="mb-2">
          El n√∫mero ingresado en el formulario llega al servidor mediante
          <code>request.form</code>.
        </p>
        <pre class="code-box mb-3"><code>numero = int(request.form.get("ingresoNumero", 0))</code></pre>

        <h5 class="fw-bold mb-2">2) Validaci√≥n del dato</h5>
        <ul class="mb-3">
          <li>Se verifica que el valor sea un entero.</li>
          <li>Se limita el rango permitido (0 a 10) para evitar n√∫meros muy grandes.</li>
          <li>Si ocurre un error, se muestra un mensaje al usuario.</li>
        </ul>

        <h5 class="fw-bold mb-2">3) Proceso / C√°lculo del factorial</h5>
        <p class="mb-2">
          El factorial se calcula multiplicando todos los n√∫meros desde 1 hasta
          el n√∫mero ingresado.
        </p>
        <pre class="code-box mb-3"><code>total = 1
for i in range(1, n + 1):
    total *= i</code></pre>

        <h5 class="fw-bold mb-2">4) Salida / Resultados</h5>
        <ul class="mb-0">
          <li>Si el c√°lculo es correcto, se muestra el factorial en pantalla.</li>
          <li>Si hay un error, se presenta un mensaje indicando el problema.</li>
        </ul>
      </div>

      <!-- EJECUTAR -->
      <div class="ej-actions">
        <a href="{{ url_for('ejecutar_ejercicio', slug=ejercicio.slug) }}#formulario"
           class="btn btn-primary btn-pill btn-lg">
          Ejecutar ejercicio
        </a>
      </div>

      <!-- FORMULARIO / RESULTADO -->
      {% if contenido %}
      <div id="formulario" class="form-shell">
        <div class="form-card">
          {{ contenido|safe }}
        </div>
      </div>
      {% endif %}

      <!-- ANTERIOR / SIGUIENTE -->
      <div class="ej-nav-bottom">

        {% if anterior %}
          <a href="{{ url_for('ver_ejercicio', slug=anterior['slug']) }}"
             class="btn btn-outline-primary btn-pill">
            <i class="bi bi-arrow-left me-1"></i> Anterior
          </a>
        {% else %}
          <button class="btn btn-outline-primary btn-pill" disabled>
            <i class="bi bi-arrow-left me-1"></i> Anterior
          </button>
        {% endif %}

        {% if siguiente %}
          <a href="{{ url_for('ver_ejercicio', slug=siguiente['slug']) }}"
             class="btn btn-primary btn-pill">
            Siguiente <i class="bi bi-arrow-right ms-1"></i>
          </a>
        {% else %}
          <button class="btn btn-primary btn-pill" disabled>
            Siguiente <i class="bi bi-arrow-right ms-1"></i>
          </button>
        {% endif %}

      </div>

    </div>
  </div>
</section>

{% endblock %}
