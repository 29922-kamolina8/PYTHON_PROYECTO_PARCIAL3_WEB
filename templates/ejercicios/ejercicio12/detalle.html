{% extends "base.html" %} {% block title %}{{ ejercicio.titulo }} ¬∑ Python
Academy{% endblock %} {% block content %}

<style>
  .hero-ej {
    background: #f8fafc;
    border-bottom: 1px solid rgba(0, 0, 0, 0.08);
    padding: 52px 0;
  }
  .hero-ej .badge {
    border-radius: 999px;
    padding: 8px 14px;
    font-weight: 700;
  }
  .hero-ej h1 {
    font-weight: 800;
    letter-spacing: -0.02em;
  }
  .hero-ej p {
    max-width: 920px;
    margin: 0 auto;
  }

  .hero-top-actions {
    display: flex;
    justify-content: center;
    margin-bottom: 14px;
  }
  .btn-pill {
    border-radius: 999px;
    padding: 10px 22px;
    font-weight: 700;
  }
  .btn-pill-sm {
    border-radius: 999px;
    padding: 8px 16px;
    font-weight: 700;
  }

  .ej-wrap {
    padding: 36px 0 70px;
  }
  .ej-panel {
    border-radius: 18px;
    border: 1px solid rgba(0, 0, 0, 0.08);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
    background: #fff;
    padding: 26px;
  }

  .explain-card {
    border: 1px solid rgba(0, 0, 0, 0.08);
    border-radius: 16px;
    padding: 18px;
    background: #fbfdff;
  }

  .code-box {
    background: #0b1220;
    color: #e6edf3;
    border-radius: 14px;
    padding: 14px;
    overflow: auto;
    font-family:
      ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",
      "Courier New", monospace;
    font-size: 0.92rem;
    white-space: pre;
    margin: 0;
  }

  .hint {
    font-size: 0.95rem;
    color: #556;
  }

  .ej-actions {
    margin-top: 18px;
    display: flex;
    justify-content: center;
  }

  .form-shell {
    margin-top: 22px;
    display: flex;
    justify-content: center;
  }
  .form-card {
    width: 100%;
    max-width: 720px;
    border-radius: 18px;
    border: 1px solid rgba(0, 0, 0, 0.08);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.06);
    background: #fff;
    padding: 22px;
  }

  .ej-nav-bottom {
    margin-top: 26px;
    padding-top: 18px;
    border-top: 1px solid rgba(0, 0, 0, 0.08);
    display: flex;
    justify-content: space-between;
    gap: 12px;
    flex-wrap: wrap;
  }
  .ej-nav-bottom .btn {
    min-width: 170px;
  }
  .table-wrap {
    width: 100%;
    overflow-x: auto;
  }
</style>

<!-- HERO -->
<section class="hero-ej">
  <div class="container text-center">
    <div class="hero-top-actions">
      <a
        href="{{ url_for('ejercicios') }}"
        class="btn btn-outline-secondary btn-pill-sm"
      >
        <i class="bi bi-arrow-left me-1"></i> Volver al men√∫
      </a>
    </div>

    <span class="badge bg-primary mb-3">{{ ejercicio.tema }}</span>
    <h1 class="display-5 mb-2">{{ ejercicio.titulo }}</h1>

    <p class="lead text-muted">
      Generaci√≥n de tablas din√°micas a partir de arreglos multidimensionales,
      utilizando recorridos autom√°ticos y control de filas y columnas.
    </p>
  </div>
</section>

<section class="ej-wrap">
  <div class="container">
    <div class="ej-panel">
      <!-- DEFINICI√ìN -->
      <div class="explain-card mb-4">
        <h4 class="fw-bold mb-2">üìò ¬øQu√© son las tablas din√°micas?</h4>

        <p>
          Una <strong>tabla din√°mica</strong> es una tabla que no se construye
          de forma fija, sino que se genera autom√°ticamente a partir de los
          datos contenidos en arreglos o matrices.
        </p>

        <p>
          El n√∫mero de filas, columnas y celdas depende directamente de la
          informaci√≥n almacenada en las estructuras de datos.
        </p>

        <pre class="code-box">
tabla[filas][columnas]  ‚Üê generadas din√°micamente
</pre
        >
      </div>

      <!-- ENUNCIADO -->
      <div class="explain-card mb-4">
        <h4 class="fw-bold mb-2">üß© Enunciado</h4>

        <p>
          Desarrollar un programa que represente pa√≠ses, provincias y ciudades
          mediante arreglos multidimensionales y genere din√°micamente tablas
          HTML que muestren esta informaci√≥n organizada por pa√≠s.
        </p>

        <p class="hint mb-0">
          Objetivo: Comprender c√≥mo los arreglos permiten construir tablas
          din√°micas sin definir previamente el n√∫mero de filas y columnas.
        </p>
      </div>

      <!-- JUSTIFICACI√ìN -->
      <div class="explain-card mb-4">
        <h4 class="fw-bold mb-2">
          üß† ¬øPor qu√© este ejercicio es de tablas din√°micas?
        </h4>

        <ul>
          <li>
            Las provincias determinan autom√°ticamente el n√∫mero de columnas
          </li>
          <li>Las ciudades determinan autom√°ticamente el n√∫mero de filas</li>
          <li>La tabla se adapta a cualquier cantidad de datos</li>
        </ul>

        <pre class="code-box">
Columnas = n√∫mero de provincias
Filas    = m√°ximo de ciudades
</pre
        >
      </div>

      <!-- RECORRIDO -->
      <div class="explain-card mb-4">
        <h4 class="fw-bold mb-2">üîÅ Recorrido de los datos</h4>

        <p>Para construir la tabla se utilizan recorridos anidados:</p>

        <pre class="code-box">
for pais:
    for provincia:
        for ciudad:
            generar celda
</pre
        >

        <p class="hint">
          Este tipo de recorrido permite construir tablas completamente
          adaptables a la informaci√≥n disponible.
        </p>
      </div>

      <div class="explain-card mb-4">
  <h4 class="fw-bold mb-3">üìå Explicaci√≥n detallada del c√≥digo (p√°rrafo en p√°rrafo)</h4>

  <!-- 1 -->
  <h5 class="fw-bold">1) Importaci√≥n de utilidades Flask</h5>
  <p>
    <code>from flask import request, render_template_string</code> importa dos piezas clave para que el ejercicio funcione
    dentro de tu plataforma. <strong>request</strong> te permite saber si el usuario solo est√° viendo la p√°gina (GET) o si
    presion√≥ el bot√≥n ‚ÄúEjecutar ejercicio‚Äù (POST). <strong>render_template_string</strong> sirve para devolver HTML
    construido desde un string en Python, sin necesidad de crear un archivo HTML extra para el resultado.
  </p>
  <pre class="code-box">from flask import request, render_template_string</pre>

  <!-- 2 -->
  <h5 class="fw-bold mt-4">2) Encabezado del ejercicio</h5>
  <p>
    Este bloque sirve para identificar el ejercicio, su tem√°tica y que fue convertido desde PHP a Python. No cambia la ejecuci√≥n,
    pero ayuda a mantener organizado el proyecto y entender r√°pidamente el objetivo del archivo.
  </p>
  <pre class="code-box"># =====================================================
# EJERCICIO: TABLAS DIN√ÅMICAS - PROVINCIAS
# CONVERSI√ìN 1:1 DESDE PHP A PYTHON
# =====================================================</pre>

  <!-- 3 -->
  <h5 class="fw-bold mt-4">3) Plantilla HTML base (variable <code>HTML</code>)</h5>
  <p>
    <code>HTML</code> guarda una plantilla en texto que luego Flask renderiza. All√≠ incluyes estilos y contenido inicial.
    En GET, se muestra el mensaje para ejecutar. En POST, se muestran las tablas generadas (cuando la plantilla est√© preparada
    para recibir <code>tablas</code> y mostrarlas).
  </p>
  <pre class="code-box">HTML = """ ... """</pre>

  <!-- 4 -->
  <h5 class="fw-bold mt-4">4) CSS para tablas y celdas</h5>
  <p>
    Se aplican estilos para que las tablas queden centradas, con fondo blanco, bordes limpios y texto alineado.
    Como las tablas se generan por c√≥digo, este CSS asegura que todas se vean iguales sin importar cu√°ntas columnas o filas existan.
  </p>
  <pre class="code-box">table{
  margin:auto;
  background:white;
  border-collapse: collapse;
}
td, th{
  padding:6px 10px;
  border:1px solid #333;
  text-align:center;
}</pre>

  <!-- 5 -->
  <h5 class="fw-bold mt-4">5) Capital resaltada con parpadeo (blink)</h5>
  <p>
    En cada provincia, la primera ciudad (posici√≥n 0) se considera la ‚Äúcapital‚Äù. Para resaltarla se aplica la clase
    <code>blink</code> que usa una animaci√≥n CSS. As√≠ el texto alterna visibilidad y llama la atenci√≥n, igual que en tu PHP original.
  </p>
  <pre class="code-box">.blink{
  animation: blink 1s linear infinite;
  font-weight:bold;
  color:black;
}
@keyframes blink {
  50% { opacity:0; }
}</pre>

  <!-- 6 -->
  <h5 class="fw-bold mt-4">6) Evitar desbordes (scroll horizontal)</h5>
  <p>
    Como el ejercicio puede tener muchas provincias (muchas columnas), en pantallas peque√±as la tabla podr√≠a salirse del contenedor.
    Con <code>overflow-x:auto</code> se habilita un scroll horizontal para mantener el dise√±o estable.
  </p>
  <pre class="code-box">.table-wrap{
  width:100%;
  overflow-x:auto;
}</pre>

  <!-- 7 -->
  <h5 class="fw-bold mt-4">7) Control GET vs POST dentro de <code>ejecutar()</code></h5>
  <p>
    La funci√≥n <code>ejecutar()</code> es llamada por tu <code>app.py</code>. Primero se valida el m√©todo HTTP:
    si es GET, no se genera nada y solo se muestra el mensaje inicial. Si es POST, se construyen tablas y se retorna el resultado.
  </p>
  <pre class="code-box">def ejecutar():

    if request.method == "GET":
        return render_template_string(HTML, mostrar=False)</pre>

  <!-- 8 -->
  <h5 class="fw-bold mt-4">8) Estructura principal <code>paises</code></h5>
  <p>
    <code>paises</code> es un diccionario anidado (3 niveles): pa√≠s ‚Üí provincia ‚Üí lista de ciudades.
    Esta estructura permite construir tablas din√°micas porque el n√∫mero de provincias define las columnas
    y el m√°ximo n√∫mero de ciudades define las filas.
  </p>
  <pre class="code-box">paises = {
  "ECUADOR": {
    "Pichincha": ["QUITO", "..."],
    "Guayas": ["GUAYAQUIL", "..."]
  }
}</pre>

  <!-- 9 -->
  <h5 class="fw-bold mt-4">9) Generaci√≥n din√°mica de tablas</h5>
  <p>
    Se recorre cada pa√≠s y se genera una tabla HTML. Primero se calcula <code>maxFilas</code> con el m√°ximo tama√±o de listas
    (para que todas las columnas tengan la misma cantidad de filas). Luego se construye el encabezado con provincias y el cuerpo
    recorriendo fila por fila.
  </p>
  <pre class="code-box">tablas = []

for pais, infoPais in paises.items():

    maxFilas = max(len(c) for c in infoPais.values())

    html = f"&lt;br&gt;&lt;strong&gt;PA√çS: {pais}&lt;/strong&gt;&lt;br&gt;"
    html += "&lt;table&gt;"
    html += f"&lt;tr&gt;&lt;th colspan='{len(infoPais)}' bgcolor='#EC7063'&gt;{pais}&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;"

    for prov in infoPais:
        html += f"&lt;th&gt;{prov}&lt;/th&gt;"
    html += "&lt;/tr&gt;"</pre>

  <!-- 10 -->
  <h5 class="fw-bold mt-4">10) Cuerpo de la tabla (capital + celdas vac√≠as)</h5>
  <p>
    En la fila 0 se imprime la capital con <code>blink</code>. En las dem√°s filas se imprime la ciudad si existe.
    Si no existe (provincia con menos ciudades), se agrega una celda vac√≠a para mantener alineadas las columnas.
  </p>
  <pre class="code-box">for i in range(maxFilas):
    html += "&lt;tr&gt;"
    for cantones in infoPais.values():
        if i == 0:
            html += f"&lt;td class='blink' bgcolor='#D6FAF2'&gt;{cantones[0]}&lt;/td&gt;"
        else:
            html += (
                f"&lt;td bgcolor='#D6FAF2'&gt;{cantones[i]}&lt;/td&gt;"
                if i &lt; len(cantones)
                else "&lt;td bgcolor='#D6DEFA'&gt; &lt;/td&gt;"
            )
    html += "&lt;/tr&gt;"</pre>

  <!-- 11 -->
  <h5 class="fw-bold mt-4">11) Render final (enviar tablas a la vista)</h5>
  <p>
    Se devuelve la plantilla renderizada y se env√≠an las variables que la vista necesita:
    <code>mostrar</code> para controlar la presentaci√≥n y <code>tablas</code> para imprimir los HTML generados.
    Para que se vean como HTML real, en la plantilla debes imprimirlas usando <code>|safe</code>.
  </p>
  <pre class="code-box">return render_template_string(
    HTML,
    mostrar=True,
    paises=paises,
    tablas=tablas
)</pre>

</div>



      <!-- C√ìDIGO COMPLETO -->
      <div class="explain-card mb-4">
        <h4 class="fw-bold">üíª C√≥digo completo del ejercicio (Python)</h4>
        <p class="hint">
          Este es el c√≥digo completo del ejercicio convertido desde PHP a
          Python, manteniendo la misma estructura de datos, recorridos y
          comportamiento visual. Analice el c√≥digo antes de ejecutarlo.
        </p>

        <pre class="code-box">
from flask import request, render_template_string

# =====================================================
# EJERCICIO: TABLAS DIN√ÅMICAS - PROVINCIAS
# CONVERSI√ìN 1:1 DESDE PHP A PYTHON
# =====================================================

HTML = """
&lt;style&gt;
table{
  margin:auto;
  background:white;
  border-collapse: collapse;
}
td, th{
  padding:6px 10px;
  border:1px solid #333;
  text-align:center;
}
.blink{
  animation: blink 1s linear infinite;
  font-weight:bold;
  color:black;
}
@keyframes blink {
  50% { opacity:0; }
}
.table-wrap{
  width:100%;
  overflow-x:auto;
}
&lt;/style&gt;

&lt;h2 class="text-center mb-3"&gt;TALLER - PROVINCIAS&lt;/h2&gt;

{% if mostrar %}

&lt;h4&gt;Cantones de las provincias de cada pa√≠s&lt;/h4&gt;
&lt;pre style="background:white; padding:15px; border-radius:10px;"&gt;
{{ paises }}
&lt;/pre&gt;

&lt;h4&gt;Representaci√≥n en Tablas&lt;/h4&gt;

{% for tabla in tablas %}
  &lt;div class="table-wrap"&gt;
    {{ tabla|safe }}
  &lt;/div&gt;
{% endfor %}

{% else %}
&lt;div class="alert alert-secondary text-center"&gt;
  Presione &lt;strong&gt;Ejecutar ejercicio&lt;/strong&gt; para visualizar las tablas din√°micas.
&lt;/div&gt;
{% endif %}
"""

def ejecutar():

    # -------------------------------------------------
    # CONTROL DE EJECUCI√ìN
    # GET ‚Üí no ejecuta el ejercicio
    # POST ‚Üí ejecuta el ejercicio
    # -------------------------------------------------
    if request.method == "GET":
        return render_template_string(HTML, mostrar=False)

    # -------------------------------------------------
    # MATRIZ PRINCIPAL (PA√çS ‚Üí PROVINCIA ‚Üí CIUDADES)
    # -------------------------------------------------
    paises = {

        "ECUADOR": {
            "Pichincha": ["QUITO","CAYAMBE","RUMI√ëAHUI","MEJ√çA","PEDRO MONCAYO","PUERTO QUITO","SAN MIGUEL DE LOS BANCOS"],
            "Guayas": ["GUAYAQUIL","DUR√ÅN","MILAGRO","DAULE","SAMBOROND√ìN","PLAYAS","BALAO"],
            "Azuay": ["CUENCA","GUALACEO","PAUTE","SANTA ISABEL","S√çGSIG","EL PAN","GIR√ìN"],
            "Manab√≠": ["PORTOVIEJO","MANTA","CHONE","JIPIJAPA","PEDERNALES","PAJ√ÅN","ROCAFUERTE"],
            "Tungurahua": ["AMBATO","BA√ëOS","CEVALLOS","P√çLLARO","PATATE","QUERO","TISALEO"],
            "Sucumb√≠os": ["NUEVA LOJA","SHUSHUFINDI","LAGO AGRIO","PUTUMAYO","CUYABENO","GONZALO PIZARRO","CASCALES"],
            "Loja": ["LOJA","CATAMAYO","MACAR√Å","ZAPOTILLO","SARAGURO","GONZANAM√Å","CELICA"]
        },

        "COLOMBIA": {
            "Cundinamarca": ["BOGOT√Å","CH√çA","ZIPAQUIR√Å","SOACHA","FACATATIV√Å","FUSAGASUG√Å","LA CALERA"],
            "Antioquia": ["MEDELL√çN","ENVIGADO","ITAG√ú√ç","RIONEGRO","BELLO","LA ESTRELLA","COPACABANA"],
            "Valle del Cauca": ["CALI","PALMIRA","YUMBO","JAMUND√ç","BUGA","BUENAVENTURA","TULU√Å"],
            "Santander": ["BUCARAMANGA","FLORIDABLANCA","GIR√ìN","PIEDECUESTA","SAN GIL","BARBOSA","ZAPATOCA"],
            "Atl√°ntico": ["BARRANQUILLA","SOLEDAD","GALAPA","PUERTO COLOMBIA","MALAMBO","TUBAR√Å","LURUACO"],
            "Bol√≠var": ["CARTAGENA","MAGANGU√â","TURBACO","MOMP√ìS","ARJONA","SIMIT√ç","SAN JUAN NEPOMUCENO"],
            "Nari√±o": ["PASTO","T√öQUERRES","IPIALES","SAMANIEGO","LA CRUZ","EL TAMBO","BARBACOAS"]
        },

        "USA": {
            "California": ["SACRAMENTO","LOS ANGELES","SAN DIEGO","SAN FRANCISCO","SAN JOS√â","FRESNO","OAKLAND"],
            "Texas": ["AUSTIN","HOUSTON","DALLAS","SAN ANTONIO","EL PASO","FORT WORTH","ARLINGTON"],
            "Florida": ["TALLAHASSEE","MIAMI","ORLANDO","TAMPA","JACKSONVILLE","SARASOTA","OCALA"],
            "New York": ["ALBANY","NYC","BUFFALO","ROCHESTER","SYRACUSE","YONKERS","UTICA"],
            "Illinois": ["SPRINGFIELD","CHICAGO","NAPERVILLE","AURORA","JOLIET","ELGIN","WAUKEGAN"],
            "Washington": ["OLYMPIA","SEATTLE","TACOMA","SPOKANE","BELLEVUE","YAKIMA","EVERETT"],
            "Georgia": ["ATLANTA","SAVANNAH","AUGUSTA","COLUMBUS","MACON","ATHENS","ALBANY"]
        },

        "CHINA": {
            "Beijing": ["BEIJING","HAIDIAN","CHAOYANG","DONGCHENG","FANGSHAN","MENTOUGOU","XICHENG"],
            "Shanghai": ["SHANGHAI","PUDONG","XUHUI","MINHANG","JINGAN","BAOSHAN","SONGJIANG"],
            "Guangdong": ["GUANGZHOU","SHENZHEN","FOSHAN","ZHUHAI","DONGGUAN","ZHONGSHAN","JIANGMEN"],
            "Zhejiang": ["HANGZHOU","NINGBO","WENZHOU","JINHUA","HUZHOU","TAIZHOU","SHAOXING"],
            "Sichuan": ["CHENGDU","MIANYANG","NANCHONG","LUZHOU","D√ÄZHOU","DEYANG","LESHAN"],
            "Hubei": ["WUHAN","YICHANG","XIANGYANG","EZHOU","HUANGGANG","JINGMEN","SHIYAN"],
            "Shandong": ["JINAN","QINGDAO","YANTAI","WEIFANG","RIZHAO","ZIBO","DEZHOU"]
        }
    }

    # -------------------------------------------------
    # GENERACI√ìN DE TABLAS DIN√ÅMICAS
    # -------------------------------------------------
    tablas = []

    for pais, infoPais in paises.items():

        maxFilas = max(len(c) for c in infoPais.values())

        html = f"&lt;br&gt;&lt;strong&gt;PA√çS: {pais}&lt;/strong&gt;&lt;br&gt;"
        html += "&lt;table&gt;"
        html += f"&lt;tr&gt;&lt;th colspan='{len(infoPais)}' bgcolor='#EC7063'&gt;{pais}&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;"

        for prov in infoPais:
            html += f"&lt;th&gt;{prov}&lt;/th&gt;"
        html += "&lt;/tr&gt;"

        for i in range(maxFilas):
            html += "&lt;tr&gt;"
            for cantones in infoPais.values():
                if i == 0:
                    html += f"&lt;td class='blink' bgcolor='#D6FAF2'&gt;{cantones[0]}&lt;/td&gt;"
                else:
                    html += (
                        f"&lt;td bgcolor='#D6FAF2'&gt;{cantones[i]}&lt;/td&gt;"
                        if i &lt; len(cantones)
                        else "&lt;td bgcolor='#D6DEFA'&gt;&nbsp;&lt;/td&gt;"
                    )
            html += "&lt;/tr&gt;"

        html += "&lt;/table&gt;&lt;br&gt;"
        tablas.append(html)

    return render_template_string(
        HTML,
        mostrar=True,
        paises=paises,
        tablas=tablas
    )
</pre
        >
      </div>

      <!-- BOT√ìN -->
      <div class="ej-actions">
        <form
          action="{{ url_for('ejecutar_ejercicio', slug=ejercicio.slug) }}#formulario"
          method="post"
        >
          <button type="submit" class="btn btn-primary btn-pill btn-lg">
            Ejecutar ejercicio
          </button>
        </form>
      </div>

      <!-- ‚úÖ FORMULARIO / SALIDA (sale despu√©s del bot√≥n) -->
      {% if contenido %}
      <div id="formulario" class="form-shell">
        <div class="form-card">{{ contenido|safe }}</div>
      </div>
      {% endif %}

      <!-- ‚úÖ ANTERIOR / SIGUIENTE -->
      <div class="ej-nav-bottom">
        {% if anterior %}
        <a
          href="{{ url_for('ver_ejercicio', slug=anterior['slug']) }}"
          class="btn btn-outline-primary btn-pill"
        >
          <i class="bi bi-arrow-left me-1"></i> Anterior
        </a>
        {% else %}
        <button class="btn btn-outline-primary btn-pill" disabled>
          <i class="bi bi-arrow-left me-1"></i> Anterior
        </button>
        {% endif %} {% if siguiente %}
        <a
          href="{{ url_for('ver_ejercicio', slug=siguiente['slug']) }}"
          class="btn btn-primary btn-pill"
        >
          Siguiente <i class="bi bi-arrow-right ms-1"></i>
        </a>
        {% else %}
        <button class="btn btn-primary btn-pill" disabled>
          Siguiente <i class="bi bi-arrow-right ms-1"></i>
        </button>
        {% endif %}
      </div>
    </div>
  </div>
</section>

{% endblock %}
