{% extends "base.html" %}
{% block title %}{{ ejercicio.titulo }} 췅 Python Academy{% endblock %}

{% block content %}

<style>
  .hero-ej{
    background:#f8fafc;
    border-bottom:1px solid rgba(0,0,0,.08);
    padding:52px 0;
  }
  .hero-ej .badge{border-radius:999px;padding:8px 14px;font-weight:700;}
  .hero-ej h1{font-weight:800;letter-spacing:-.02em;}
  .hero-ej p{max-width:920px;margin:0 auto;}

  .hero-top-actions{display:flex;justify-content:center;margin-bottom:14px;}
  .btn-pill{border-radius:999px;padding:10px 22px;font-weight:700;}
  .btn-pill-sm{border-radius:999px;padding:8px 16px;font-weight:700;}

  .ej-wrap{padding:36px 0 70px;}
  .ej-panel{
    border-radius:18px;border:1px solid rgba(0,0,0,.08);
    box-shadow:0 10px 25px rgba(0,0,0,.05);
    background:#fff;padding:26px;
  }

  .ej-actions{
    margin-top:18px;padding-top:18px;
    border-top:1px solid rgba(0,0,0,.08);
    display:flex;justify-content:center;
  }

  .form-shell{margin-top:22px;display:flex;justify-content:center;}
  .form-card{
    width:100%;max-width:760px;
    border-radius:18px;border:1px solid rgba(0,0,0,.08);
    box-shadow:0 10px 25px rgba(0,0,0,.06);
    background:#fff;padding:22px;
  }
  .form-card *{max-width:100%;}

  .ej-nav-bottom{
    margin-top:26px;
    padding-top:18px;
    border-top:1px solid rgba(0,0,0,.08);
    display:flex;justify-content:space-between;
    gap:12px;flex-wrap:wrap;
  }
  .ej-nav-bottom .btn{min-width:170px;}

  .explain-card{
    border:1px solid rgba(0,0,0,.08);
    border-radius:16px;
    padding:18px;
    background:#fbfdff;
  }

  .code-box{
    background:#0b1220;
    color:#e6edf3;
    border-radius:14px;
    padding:14px;
    overflow:auto;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,"Courier New", monospace;
    font-size:.92rem;
    white-space:pre;
    margin:0;
  }
  .hint{font-size:.95rem;color:#556;}
</style>

<!-- HERO -->
<section class="hero-ej">
  <div class="container text-center">

    <div class="hero-top-actions">
      <a href="{{ url_for('ejercicios') }}" class="btn btn-outline-secondary btn-pill-sm">
        <i class="bi bi-arrow-left me-1"></i> Volver al men칰
      </a>
    </div>

    <span class="badge bg-primary mb-3">{{ ejercicio.tema }}</span>
    <h1 class="display-5 mb-2">{{ ejercicio.titulo }}</h1>
    <p class="lead text-muted">{{ ejercicio.descripcion }}</p>
  </div>
</section>

<!-- CONTENIDO -->
<section class="ej-wrap">
  <div class="container">
    <div class="ej-panel">

      <!-- ENUNCIADO -->
      <div class="explain-card mb-4">
        <h4 class="fw-bold mb-2">游빌 Enunciado</h4>
        <p class="mb-2">
          En este ejercicio se desarrolla un programa en Python y Flask que
          permite al usuario ingresar un n칰mero de filas y generar el
          <b>Tri치ngulo de Pascal</b>.
        </p>
        <p class="mb-0 hint">
          Objetivo: comprender el uso de listas, bucles y l칩gica matem치tica,
          adem치s del manejo de formularios con Flask.
        </p>
      </div>

      <!-- EXPLICACI칍N -->
      <div class="explain-card mb-4">
        <h4 class="fw-bold mb-3">游늷 Explicaci칩n del c칩digo (paso a paso)</h4>

        <h5 class="fw-bold mb-2">0) Idea general (GET vs POST)</h5>
        <ul class="mb-3">
          <li><b>GET:</b> se muestra el formulario para ingresar el n칰mero de filas.</li>
          <li><b>POST:</b> el usuario presiona <b>Generar</b> y el servidor construye el tri치ngulo.</li>
          <li>Flask identifica el m칠todo con <code>request.method</code>.</li>
        </ul>

        <h5 class="fw-bold mb-2">1) Entrada del usuario</h5>
        <p class="mb-2">
          El usuario ingresa el n칰mero de filas (entre 1 y 10). Este valor se recibe
          desde el formulario mediante <code>request.form</code>.
        </p>
        <pre class="code-box mb-3"><code>filas = int(request.form.get("numfilas"))</code></pre>

        <h5 class="fw-bold mb-2">2) Generaci칩n del Tri치ngulo de Pascal</h5>
        <p class="mb-2">
          El tri치ngulo se genera usando una lista de listas. Cada fila comienza y
          termina con <b>1</b>, y los valores intermedios se obtienen sumando los
          dos valores superiores.
        </p>
        <pre class="code-box mb-3"><code>pascal[i].append(pascal[i-1][j-1] + pascal[i-1][j])</code></pre>

        <h5 class="fw-bold mb-2">3) Validaci칩n del rango</h5>
        <p class="mb-2">
          Se controla que el n칰mero de filas est칠 entre <b>1 y 10</b>. Si no cumple,
          el programa no genera el tri치ngulo.
        </p>

        <h5 class="fw-bold mb-2">4) Formateo para visualizaci칩n</h5>
        <p class="mb-2">
          Una vez generado, el tri치ngulo se formatea en HTML usando texto
          monoespaciado para que se vea centrado y ordenado.
        </p>
        <pre class="code-box mb-3"><code>&lt;pre&gt; ... valores del tri치ngulo ... &lt;/pre&gt;</code></pre>

        <h5 class="fw-bold mb-2">5) Salida / Resultados</h5>
        <ul class="mb-0">
          <li>Se muestra el tri치ngulo de Pascal centrado debajo del formulario.</li>
          <li>Si no hay datos v치lidos, no se muestra ning칰n resultado.</li>
        </ul>
      </div>

      <!-- EJECUTAR -->
      <div class="ej-actions">
        <a href="{{ url_for('ejecutar_ejercicio', slug=ejercicio.slug) }}#formulario"
           class="btn btn-primary btn-pill btn-lg">
          Ejecutar ejercicio
        </a>
      </div>

      <!-- FORMULARIO / RESULTADO -->
      {% if contenido %}
      <div id="formulario" class="form-shell">
        <div class="form-card">
          {{ contenido|safe }}
        </div>
      </div>
      {% endif %}

      <!-- ANTERIOR / SIGUIENTE -->
      <div class="ej-nav-bottom">

        {% if anterior %}
          <a href="{{ url_for('ver_ejercicio', slug=anterior['slug']) }}"
             class="btn btn-outline-primary btn-pill">
            <i class="bi bi-arrow-left me-1"></i> Anterior
          </a>
        {% else %}
          <button class="btn btn-outline-primary btn-pill" disabled>
            <i class="bi bi-arrow-left me-1"></i> Anterior
          </button>
        {% endif %}

        {% if siguiente %}
          <a href="{{ url_for('ver_ejercicio', slug=siguiente['slug']) }}"
             class="btn btn-primary btn-pill">
            Siguiente <i class="bi bi-arrow-right ms-1"></i>
          </a>
        {% else %}
          <button class="btn btn-primary btn-pill" disabled>
            Siguiente <i class="bi bi-arrow-right ms-1"></i>
          </button>
        {% endif %}

      </div>

    </div>
  </div>
</section>

{% endblock %}
