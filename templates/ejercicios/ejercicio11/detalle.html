{% extends "base.html" %}
{% block title %}{{ ejercicio.titulo }} ¬∑ Python Academy{% endblock %}

{% block content %}

<style>
.hero-ej{
    background:#f8fafc;
    border-bottom:1px solid rgba(0,0,0,.08);
    padding:52px 0;
  }
  .hero-ej .badge{border-radius:999px;padding:8px 14px;font-weight:700;}
  .hero-ej h1{font-weight:800;letter-spacing:-.02em;}
  .hero-ej p{max-width:920px;margin:0 auto;}

  .hero-top-actions{
    display:flex;
    justify-content:center;
    margin-bottom:14px;
  }
  .btn-pill{border-radius:999px;padding:10px 22px;font-weight:700;}
  .btn-pill-sm{border-radius:999px;padding:8px 16px;font-weight:700;}

  .ej-wrap{padding:36px 0 70px;}
  .ej-panel{
    border-radius:18px;border:1px solid rgba(0,0,0,.08);
    box-shadow:0 10px 25px rgba(0,0,0,.05);
    background:#fff;padding:26px;
  }

  /* Bloques tipo tarjeta */
  .explain-card{
    border:1px solid rgba(0,0,0,.08);
    border-radius:16px;
    padding:18px;
    background:#fbfdff;
  }

  /* Bloques de c√≥digo */
  .code-box{
    background:#0b1220;
    color:#e6edf3;
    border-radius:14px;
    padding:14px;
    overflow:auto;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    font-size: 0.92rem;
    white-space: pre; /* respeta enter + espacios */
    margin: 0;
  }

  .hint{ font-size:.95rem; color:#556; }

  /* Bot√≥n ejecutar */
  .ej-actions{
    margin-top:18px;
    display:flex;
    justify-content:center;
  }

  /* Formulario/Salida */
  .form-shell{margin-top:22px;display:flex;justify-content:center;}
  .form-card{
    width:100%;
    max-width:720px;
    border-radius:18px;border:1px solid rgba(0,0,0,.08);
    box-shadow:0 10px 25px rgba(0,0,0,.06);
    background:#fff;padding:22px;
  }
  .form-card *{max-width:100%;}

  /* Navegaci√≥n inferior */
  .ej-nav-bottom{
    margin-top:26px;
    padding-top:18px;
    border-top:1px solid rgba(0,0,0,.08);
    display:flex;
    justify-content:space-between;
    gap:12px;
    flex-wrap:wrap;
  }
  .ej-nav-bottom .btn{ min-width:170px; }
</style>

<!-- HERO -->
<section class="hero-ej">
  <div class="container text-center">

    <!-- Volver al men√∫ -->
    <div class="hero-top-actions">
      <a href="{{ url_for('ejercicios') }}" class="btn btn-outline-secondary btn-pill-sm">
        <i class="bi bi-arrow-left me-1"></i> Volver al men√∫
      </a>
    </div>

    <span class="badge bg-primary mb-3">{{ ejercicio.tema }}</span>
    <h1 class="display-5 mb-2">{{ ejercicio.titulo }}</h1>

    <!-- ‚úÖ Se mantiene la DESCRIPCI√ìN CORTA -->
    <p class="lead text-muted">
      {{ ejercicio.descripcion }}
    </p>
  </div>
</section>
  <section class="py-5">
    <div class="container">

      <div class="container">

      <!-- DEFINICI√ìN CLAVE -->
      <div class="explain-card mb-4">
        <h4 class="fw-bold mb-2">üìò ¬øQu√© es un arreglo c√∫bico?</h4>

        <p>
          Un <strong>arreglo c√∫bico</strong> es una estructura de datos
          <strong>tridimensional</strong>, donde la informaci√≥n se organiza
          en tres niveles jer√°rquicos.
        </p>

        <p>
          Matem√°ticamente, un arreglo c√∫bico se puede representar como:
        </p>

  <pre class="code-box">
  arreglo[ dimensi√≥n_1 ][ dimensi√≥n_2 ][ dimensi√≥n_3 ]
  </pre>

        <p>
          Cada dimensi√≥n representa un nivel diferente de agrupaci√≥n de datos.
          A diferencia de un arreglo bidimensional (filas y columnas),
          el arreglo c√∫bico a√±ade una <strong>tercera profundidad</strong>.
        </p>
      </div>
          <!-- ENUNCIADO -->
      <div class="explain-card mb-4">
        <h4 class="fw-bold mb-2">üß© Enunciado</h4>

        <p>
          Desarrollar un programa que utilice arreglos y matrices
          multidimensionales para representar pa√≠ses, provincias y ciudades.
          El sistema debe recorrer dichas estructuras y generar din√°micamente
          tablas HTML que muestren la informaci√≥n organizada.
        </p>

        <p class="hint mb-0">
          Objetivo: Comprender el uso de arreglos indexados, arreglos asociativos
          y recorridos tipo matriz aplicados a un entorno web.
        </p>
      </div>

      <!-- POR QU√â ES C√öBICO -->
      <div class="explain-card mb-4">
        <h4 class="fw-bold mb-2">üß† ¬øPor qu√© este ejercicio es un arreglo c√∫bico?</h4>

        <p>
          Este ejercicio es c√∫bico porque la informaci√≥n se organiza
          en <strong>tres dimensiones claramente definidas</strong>:
        </p>

        <ul>
          <li><strong>Primera dimensi√≥n:</strong> Pa√≠s</li>
          <li><strong>Segunda dimensi√≥n:</strong> Provincia</li>
          <li><strong>Tercera dimensi√≥n:</strong> Ciudad (cant√≥n)</li>
        </ul>

  <pre class="code-box">
  Pais[PAIS][PROVINCIA][CIUDAD]
  </pre>

        <p>
          Cada pa√≠s contiene varias provincias y cada provincia contiene
          varias ciudades. Esta relaci√≥n jer√°rquica es lo que convierte
          al ejercicio en un <strong>arreglo c√∫bico</strong>.
        </p>
      </div>

      <!-- ESTRUCTURAS -->
      <div class="explain-card mb-4">
        <h4 class="fw-bold mb-2">üìÇ Estructuras de datos utilizadas</h4>

        <p>
          Se utilizan dos tipos de arreglos:
        </p>

        <ul>
          <li>Arreglos indexados para las ciudades</li>
          <li>Arreglos asociativos para pa√≠ses y provincias</li>
        </ul>

  <pre class="code-box">
  cantones = [
    ["QUITO","CAYAMBE","RUMI√ëAHUI"],
    ["GUAYAQUIL","DAULE","SAMBORONDON","BAEZA"]
  ]

  Pais = {
    "ECUADOR": {
      "Pichincha": ["QUITO","CAYAMBE","RUMI√ëAHUI"],
      "Guayas": cantones[1]
    }
  }
  </pre>
      </div>

      <!-- RECORRIDO -->
      <div class="explain-card mb-4">
        <h4 class="fw-bold mb-2">üîÅ Recorrido del arreglo c√∫bico</h4>

        <p>
          Para mostrar los datos en forma de tabla,
          se realiza un recorrido tridimensional:
        </p>

        <ol>
          <li>Se recorre cada pa√≠s</li>
          <li>Dentro de cada pa√≠s, se recorren las provincias</li>
          <li>Dentro de cada provincia, se recorren las ciudades</li>
        </ol>

  <pre class="code-box">
  for pais in Pais:
      for provincia in Pais[pais]:
          for ciudad in Pais[pais][provincia]:
              procesar ciudad
  </pre>

        <p>
          Este recorrido es caracter√≠stico de los arreglos c√∫bicos,
          ya que implica tres niveles de iteraci√≥n.
        </p>
      </div>

    <!-- EXPLICACI√ìN -->
   <div class="explain-card mb-4">
  <h4 class="fw-bold mb-3">üìå Explicaci√≥n del c√≥digo (l√≠nea por l√≠nea)</h4>

  <!-- BLOQUE 1 -->
  <h5 class="fw-bold">1) Importaci√≥n de librer√≠as necesarias</h5>
  <p>
    Se importan los componentes requeridos del framework Flask para poder
    manejar la interacci√≥n con el usuario y mostrar resultados din√°micos
    en una aplicaci√≥n web.
  </p>
  <ul>
    <li><code>request</code>: permite obtener los datos enviados desde el formulario.</li>
    <li><code>render_template_string</code>: permite renderizar HTML directamente desde Python.</li>
  </ul>

<pre class="code-box">
from flask import request, render_template_string
</pre>

  <!-- BLOQUE 2 -->
  <h5 class="fw-bold mt-4">2) Definici√≥n de la plantilla HTML base</h5>
  <p>
    Se define una plantilla HTML que controla dos estados del ejercicio:
  </p>
  <ul>
    <li><strong>Estado inicial:</strong> muestra √∫nicamente el formulario.</li>
    <li><strong>Estado de ejecuci√≥n:</strong> muestra el arreglo original y el arreglo con los cubos.</li>
  </ul>
  <p class="hint">
    Esta estructura evita que el ejercicio se ejecute autom√°ticamente al cargar la p√°gina.
  </p>

<pre class="code-box">
HTML = """
&lt;h4 class="mb-3 text-center"&gt;Ejemplo: Arreglos y C√°lculo de Cubos&lt;/h4&gt;

&lt;form method="post"&gt;
  &lt;input type="text" name="numeros"&gt;
  &lt;button type="submit"&gt;Ejecutar&lt;/button&gt;
&lt;/form&gt;

{% if mostrar %}
  &lt;p&gt;Arreglo original: {{ lista }}&lt;/p&gt;
  &lt;p&gt;Cubos calculados: {{ cubos }}&lt;/p&gt;
{% endif %}
"""
</pre>

  <!-- BLOQUE 3 -->
  <h5 class="fw-bold mt-4">3) Recepci√≥n de datos desde el formulario</h5>
  <p>
    Cuando el usuario presiona el bot√≥n de ejecutar, los datos ingresados
    en el formulario son enviados mediante una petici√≥n <strong>POST</strong>.
    Estos datos se reciben como una cadena de texto.
  </p>

<pre class="code-box">
numeros = request.form.get("numeros")
</pre>

  <!-- BLOQUE 4 -->
  <h5 class="fw-bold mt-4">4) Conversi√≥n de texto a arreglo de enteros</h5>
  <p>
    La cadena ingresada por el usuario contiene n√∫meros separados por comas.
    Se utiliza una comprensi√≥n de listas para:
  </p>
  <ul>
    <li>Separar la cadena usando <code>split(",")</code></li>
    <li>Convertir cada valor a tipo entero</li>
    <li>Almacenar los valores en un arreglo (lista)</li>
  </ul>

<pre class="code-box">
lista = [int(n) for n in numeros.split(",")]
</pre>

  <!-- BLOQUE 5 -->
  <h5 class="fw-bold mt-4">5) Declaraci√≥n del arreglo para almacenar los cubos</h5>
  <p>
    Se declara un arreglo vac√≠o llamado <code>cubos</code>.
    En este arreglo se almacenar√° el resultado del c√°lculo
    del cubo de cada n√∫mero ingresado.
  </p>

<pre class="code-box">
cubos = []
</pre>

  <!-- BLOQUE 6 -->
  <h5 class="fw-bold mt-4">6) Recorrido del arreglo y c√°lculo del cubo</h5>
  <p>
    Se recorre el arreglo <code>lista</code> utilizando un ciclo <code>for</code>.
    En cada iteraci√≥n se calcula el cubo del n√∫mero actual elev√°ndolo
    a la potencia de 3.
  </p>
  <p class="hint">
    Matem√°ticamente: cubo = n √ó n √ó n
  </p>

<pre class="code-box">
for n in lista:
    cubos.append(n ** 3)
</pre>

  <!-- BLOQUE 7 -->
  <h5 class="fw-bold mt-4">7) Env√≠o de resultados a la vista</h5>
  <p>
    Finalmente, se env√≠an el arreglo original y el arreglo con los cubos
    a la plantilla HTML para ser mostrados al usuario.
  </p>
  <p>
    Esto permite visualizar claramente la relaci√≥n entre los datos de entrada
    y los resultados obtenidos.
  </p>

<pre class="code-box">
return render_template_string(
    HTML,
    mostrar=True,
    lista=lista,
    cubos=cubos
)
</pre>

  <!-- BLOQUE 8 -->
  <h5 class="fw-bold mt-4">8) Resultado final del ejercicio</h5>
  <p>
    El programa muestra:
  </p>
  <ul>
    <li>El arreglo original ingresado por el usuario.</li>
    <li>Un nuevo arreglo que contiene el cubo de cada elemento.</li>
  </ul>

  <p class="hint mt-3">
    Este ejercicio refuerza conceptos fundamentales como:
    arreglos indexados, recorridos secuenciales, operaciones matem√°ticas
    y transformaci√≥n de datos mediante programaci√≥n estructurada.
  </p>
</div>


        <div class="explain-card">
      <h4 class="fw-bold">üíª C√≥digo completo del ejercicio (Python)</h4>
      <p class="hint">
        Analice cuidadosamente el c√≥digo antes de ejecutar el ejercicio.
      </p>

<pre class="code-box">
from flask import request, render_template_string

HTML = """
&lt;h4 class="text-center mb-3"&gt;TALLER - PAISES&lt;/h4&gt;

{% if mostrar %}
  {% for tabla in tablas %}
    {{ tabla|safe }}
  {% endfor %}
{% else %}
  &lt;div class="alert alert-secondary text-center"&gt;
    Presione &lt;strong&gt;Ejecutar ejercicio&lt;/strong&gt; para visualizar las tablas.
  &lt;/div&gt;
{% endif %}
"""

def ejecutar():

    cantones = [
        ["QUITO","CAYAMBE","RUMI√ëAHUI"],
        ["GUAYAQUIL","DAULE","SAMBORONDON","BAEZA"],
        ["CUENCA","LOJA"],
        ["ROCAFUERTE","CHONE"]
    ]

    Pais = {
        "ECUADOR": {
            "Pichincha": ["QUITO","CAYAMBE","RUMI√ëAHUI"],
            "Guayas": cantones[1],
            "Azuay": ["Cuenca"],
            "Manabi": cantones[3],
            "Tunguragua": ["Ambato"]
        }
    }

    if request.method == "GET":
        return render_template_string(HTML, mostrar=False)

    tablas = []

    for pais, info in Pais.items():
        maxColum = max(len(v) for v in info.values())

        html = f"&lt;b&gt;PAIS : {pais}&lt;/b&gt;&lt;br&gt;"
        html += f"MAXCOLUM: {maxColum}&lt;br&gt;"
        html += f"NUMERO DE PROVINCIAS: {len(info)}&lt;br&gt;&lt;br&gt;"

        html += "&lt;table border='1'&gt;"
        html += f"&lt;tr&gt;&lt;th colspan='{len(info)}'&gt;{pais}&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;"

        for prov in info.keys():
            html += f"&lt;th&gt;{prov}&lt;/th&gt;"
        html += "&lt;/tr&gt;"

        for f in range(maxColum):
            html += "&lt;tr&gt;"
            for data in info.values():
                html += f"&lt;td&gt;{data[f] if f &lt; len(data) else ''}&lt;/td&gt;"
            html += "&lt;/tr&gt;"

        html += "&lt;/table&gt;&lt;br&gt;&lt;br&gt;"
        tablas.append(html)

    return render_template_string(HTML, mostrar=True, tablas=tablas)
</pre>
    </div>

    <!-- BOT√ìN -->
      <!-- ‚úÖ BOT√ìN EJECUTAR -->
      <div class="ej-actions">
        <a href="{{ url_for('ejecutar_ejercicio', slug=ejercicio.slug) }}#formulario"
           class="btn btn-primary btn-pill btn-lg">
          Ejecutar ejercicio
        </a>
      </div>

      <!-- ‚úÖ FORMULARIO / SALIDA (sale despu√©s del bot√≥n) -->
      {% if contenido %}
      <div id="formulario" class="form-shell">
        <div class="form-card">
          {{ contenido|safe }}
        </div>
      </div>
      {% endif %}

      <!-- ‚úÖ ANTERIOR / SIGUIENTE -->
      <div class="ej-nav-bottom">

        {% if anterior %}
          <a href="{{ url_for('ver_ejercicio', slug=anterior['slug']) }}" class="btn btn-outline-primary btn-pill">
            <i class="bi bi-arrow-left me-1"></i> Anterior
          </a>
        {% else %}
          <button class="btn btn-outline-primary btn-pill" disabled>
            <i class="bi bi-arrow-left me-1"></i> Anterior
          </button>
        {% endif %}

        {% if siguiente %}
          <a href="{{ url_for('ver_ejercicio', slug=siguiente['slug']) }}" class="btn btn-primary btn-pill">
            Siguiente <i class="bi bi-arrow-right ms-1"></i>
          </a>
        {% else %}
          <button class="btn btn-primary btn-pill" disabled>
            Siguiente <i class="bi bi-arrow-right ms-1"></i>
          </button>
        {% endif %}

      </div>


  </div>
</section>

{% endblock %}