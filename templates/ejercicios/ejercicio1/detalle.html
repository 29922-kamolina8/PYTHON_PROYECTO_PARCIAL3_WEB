{% extends "base.html" %}
{% block title %}{{ ejercicio.titulo }} ¬∑ Python Academy{% endblock %}

{% block content %}

<style>
  .hero-ej{
    background:#f8fafc;
    border-bottom:1px solid rgba(0,0,0,.08);
    padding:52px 0;
  }
  .hero-ej .badge{border-radius:999px;padding:8px 14px;font-weight:700;}
  .hero-ej h1{font-weight:800;letter-spacing:-.02em;}
  .hero-ej p{max-width:920px;margin:0 auto;}

  .hero-top-actions{display:flex;justify-content:center;margin-bottom:14px;}
  .btn-pill{border-radius:999px;padding:10px 22px;font-weight:700;}
  .btn-pill-sm{border-radius:999px;padding:8px 16px;font-weight:700;}

  .ej-wrap{padding:36px 0 70px;}
  .ej-panel{
    border-radius:18px;border:1px solid rgba(0,0,0,.08);
    box-shadow:0 10px 25px rgba(0,0,0,.05);
    background:#fff;padding:26px;
  }

  .ej-actions{
    margin-top:18px;padding-top:18px;
    border-top:1px solid rgba(0,0,0,.08);
    display:flex;justify-content:center;
  }

  .form-shell{margin-top:22px;display:flex;justify-content:center;}
  .form-card{
    width:100%;max-width:720px;
    border-radius:18px;border:1px solid rgba(0,0,0,.08);
    box-shadow:0 10px 25px rgba(0,0,0,.06);
    background:#fff;padding:22px;
  }
  .form-card *{max-width:100%;}

  .ej-nav-bottom{
    margin-top:26px;
    padding-top:18px;
    border-top:1px solid rgba(0,0,0,.08);
    display:flex;justify-content:space-between;
    gap:12px;flex-wrap:wrap;
  }
  .ej-nav-bottom .btn{min-width:170px;}

  .explain-card{
    border:1px solid rgba(0,0,0,.08);
    border-radius:16px;
    padding:18px;
    background:#fbfdff;
  }

  .code-box{
    background:#0b1220;
    color:#e6edf3;
    border-radius:14px;
    padding:14px;
    overflow:auto;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
    font-size:.92rem;
    white-space:pre;
    margin:0;
  }
  .hint{font-size:.95rem;color:#556;}
</style>

<!-- HERO -->
<section class="hero-ej">
  <div class="container text-center">

    <div class="hero-top-actions">
      <a href="{{ url_for('ejercicios') }}" class="btn btn-outline-secondary btn-pill-sm">
        <i class="bi bi-arrow-left me-1"></i> Volver al men√∫
      </a>
    </div>

    <span class="badge bg-primary mb-3">{{ ejercicio.tema }}</span>
    <h1 class="display-5 mb-2">{{ ejercicio.titulo }}</h1>
    <p class="lead text-muted">{{ ejercicio.descripcion }}</p>
  </div>
</section>

<!-- CONTENIDO -->
<section class="ej-wrap">
  <div class="container">
    <div class="ej-panel">

      <!-- ‚úÖ ENUNCIADO REAL -->
      <div class="explain-card mb-4">
        <h4 class="fw-bold mb-2">üß© Enunciado</h4>
        <p class="mb-2">
          En este ejercicio vamos a construir un <b>formulario de figuras</b> en Flask.
          El usuario podr√° escoger una figura (<b>cuadrado</b>, <b>rect√°ngulo</b> o <b>tri√°ngulo</b>)
          e ingresar sus lados.
        </p>
        <p class="mb-0 hint">
          Objetivo: practicar <code>GET</code> vs <code>POST</code>, validaci√≥n de entradas y mostrar resultados (√°rea y per√≠metro).
        </p>
      </div>

<div class="explain-card mb-4">
  <h4 class="fw-bold mb-3">üìå Explicaci√≥n del c√≥digo (paso a paso)</h4>

  <h5 class="fw-bold mb-2">0) Idea general (GET vs POST)</h5>
  <ul class="mb-3">
    <li><b>GET:</b> el usuario entra a la p√°gina ‚Üí se muestra el formulario vac√≠o.</li>
    <li><b>POST:</b> el usuario llena los datos y presiona <b>Calcular</b> ‚Üí Flask procesa y muestra <b>resultado</b> o <b>errores</b>.</li>
    <li>En Flask detectamos con <code>request.method</code>.</li>
  </ul>

  <h5 class="fw-bold mb-2">1) ¬øQu√© datos se env√≠an?</h5>
  <p class="mb-2">
    El formulario env√≠a 4 campos: la <b>figura</b> y los lados <b>l1</b>, <b>l2</b>, <b>l3</b>.
    Todo llega por <code>request.form</code> porque no hay archivos.
  </p>
  <pre class="code-box mb-3"><code>figura = request.form.get("figura")
l1 = request.form.get("l1")
l2 = request.form.get("l2")
l3 = request.form.get("l3")</code></pre>

  <h5 class="fw-bold mb-2">2) Guardar lo que escribi√≥ el usuario (para no perderlo)</h5>
  <p class="mb-2">
    Se usa <code>form_data</code> para que, si hay errores, el formulario se recargue con los valores que el usuario ya escribi√≥.
  </p>
  <pre class="code-box mb-3"><code>form_data = {"figura": figura, "l1": l1, "l2": l2, "l3": l3}</code></pre>

  <h5 class="fw-bold mb-2">3) Validaci√≥n + c√°lculo con <code>process_figure()</code></h5>
  <p class="mb-2">
    La funci√≥n <code>process_figure(figura, l1, l2, l3)</code> hace TODO lo importante:
  </p>
  <ul class="mb-3">
    <li>Verifica que se haya escogido una figura v√°lida.</li>
    <li>Convierte cada lado a n√∫mero y valida que sea <b>positivo</b> (si no, agrega errores).</li>
    <li>Calcula <b>√°rea</b> y <b>per√≠metro</b> seg√∫n la figura.</li>
  </ul>
  <pre class="code-box mb-3"><code>result, errors = process_figure(figura, l1, l2, l3)</code></pre>

  <h5 class="fw-bold mb-2">4) ¬øC√≥mo calcula cada figura?</h5>
  <ul class="mb-3">
    <li><b>Cuadrado:</b> usa solo <code>l1</code> ‚Üí √°rea = l1¬≤, per√≠metro = 4¬∑l1.</li>
    <li><b>Rect√°ngulo:</b> usa <code>l1</code> y <code>l2</code> ‚Üí √°rea = l1¬∑l2, per√≠metro = 2¬∑(l1+l2).</li>
    <li><b>Tri√°ngulo:</b> usa <code>l1</code>, <code>l2</code>, <code>l3</code> ‚Üí primero valida desigualdad triangular y luego calcula.</li>
  </ul>

  <h5 class="fw-bold mb-2">5) Tri√°ngulo: validaci√≥n + √°rea (F√≥rmula de Her√≥n)</h5>
  <p class="mb-2">
    Para tri√°ngulo, se valida que los lados s√≠ formen un tri√°ngulo:
    <code>a+b&gt;c</code>, <code>a+c&gt;b</code> y <code>b+c&gt;a</code>.
    Si es v√°lido, se calcula el √°rea con Her√≥n:
  </p>
  <pre class="code-box mb-3"><code>perimetro = a + b + c
s = perimetro / 2
area = sqrt(s*(s-a)*(s-b)*(s-c))</code></pre>

  <h5 class="fw-bold mb-2">6) Tipo de tri√°ngulo</h5>
  <p class="mb-3">
    Si es tri√°ngulo v√°lido, tambi√©n se clasifica como:
    <b>equil√°tero</b> (3 iguales), <b>is√≥sceles</b> (2 iguales) o <b>escaleno</b> (todos distintos).
  </p>

  <h5 class="fw-bold mb-2">7) Salida final (qu√© se muestra al usuario)</h5>
  <ul class="mb-0">
    <li>Si hay <b>errores</b>, se muestran en un recuadro rojo (<code>alert</code>).</li>
    <li>Si hay <b>resultado</b>, se muestran la figura, lados, √°rea, per√≠metro y (si aplica) tipo de tri√°ngulo.</li>
  </ul>
</div>


      <!-- ‚úÖ Ejecutar -->
      <div class="ej-actions">
        <a href="{{ url_for('ejecutar_ejercicio', slug=ejercicio.slug) }}#formulario"
           class="btn btn-primary btn-pill btn-lg">
          Ejecutar ejercicio
        </a>
      </div>

      <!-- Formulario / salida -->
      {% if contenido %}
      <div id="formulario" class="form-shell">
        <div class="form-card">
          {{ contenido|safe }}
        </div>
      </div>
      {% endif %}

      <!-- ‚úÖ Anterior / Siguiente -->
      <div class="ej-nav-bottom">

        {% if anterior %}
          <a href="{{ url_for('ver_ejercicio', slug=anterior['slug']) }}" class="btn btn-outline-primary btn-pill">
            <i class="bi bi-arrow-left me-1"></i> Anterior
          </a>
        {% else %}
          <button class="btn btn-outline-primary btn-pill" disabled>
            <i class="bi bi-arrow-left me-1"></i> Anterior
          </button>
        {% endif %}

        {% if siguiente %}
          <a href="{{ url_for('ver_ejercicio', slug=siguiente['slug']) }}" class="btn btn-primary btn-pill">
            Siguiente <i class="bi bi-arrow-right ms-1"></i>
          </a>
        {% else %}
          <button class="btn btn-primary btn-pill" disabled>
            Siguiente <i class="bi bi-arrow-right ms-1"></i>
          </button>
        {% endif %}

      </div>

    </div>
  </div>
</section>

{% endblock %}
