{% extends "base.html" %}

{% block title %}Sintaxis y Comentarios - Python Academy{% endblock %}

{% block content %}
<!-- ================= HERO ================= -->
<section class="py-5 bg-light border-bottom">
  <div class="container text-center">
    <span class="badge bg-primary mb-3">TEMA 4</span>
    <h1 class="display-5 fw-bold text-dark">Sintaxis y Comentarios</h1>
    <p class="lead text-muted mx-auto" style="max-width: 780px;">
      La regla de oro de Python: la indentaci√≥n no es est√©tica, es obligatoria.
      Aprende a escribir c√≥digo claro y bien documentado con comentarios correctos en Python y HTML.
    </p>
  </div>
</section>

<section class="section py-5">
  <div class="container">
    <div class="row justify-content-start">

      <!-- ================= SIDEBAR ================= -->
      <div class="col-lg-3 d-none d-lg-block">
        <nav class="sidebar-nav">
          <h5><i class="bi bi-list-check me-2"></i>Contenido</h5>
          <ul>
            {% for subtema in tema.subtemas %}
            <li>
              <a href="#{{ subtema.id }}" class="{% if loop.first %}active{% endif %}">
                {{ subtema.titulo }}
              </a>
            </li>
            {% endfor %}
          </ul>
        </nav>
      </div>

      <!-- ================= MAIN ================= -->
      <div class="col-lg-8">

        <!-- ========================================================= -->
        <!-- 1) INDENTACI√ìN -->
        <!-- ========================================================= -->
        <h3 class="fw-bold mb-3" id="indentacion">La indentaci√≥n en Python</h3>
        <p>
          A diferencia de lenguajes como Java o C++ que usan llaves <code>{}</code> para definir bloques,
          Python usa <strong>indentaci√≥n (sangr√≠a)</strong>. Eso obliga a escribir c√≥digo ordenado y legible.
        </p>

        <div class="row mt-4 g-3">
          <div class="col-md-6">
            <div class="card border-success h-100">
              <div class="card-header bg-success text-white fw-bold">‚úÖ Correcto</div>
              <div class="card-body bg-light font-monospace">
                if 5 &gt; 2:<br>
                &nbsp;&nbsp;&nbsp;&nbsp;print("Cinco es mayor")
              </div>
              <div class="card-footer text-muted small">
                El bloque dentro del <code>if</code> est√° indentado.
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="card border-danger h-100">
              <div class="card-header bg-danger text-white fw-bold">‚ùå Error (IndentationError)</div>
              <div class="card-body bg-light font-monospace">
                if 5 &gt; 2:<br>
                print("Cinco es mayor")
              </div>
              <div class="card-footer text-muted small">
                Falta sangr√≠a: Python no sabe qu√© pertenece al bloque.
              </div>
            </div>
          </div>
        </div>

        <div class="alert alert-warning mt-3 d-flex align-items-center">
          <i class="bi bi-exclamation-triangle-fill me-2"></i>
          <div>
            <strong>Recomendaci√≥n:</strong> usa <strong>4 espacios</strong> por nivel de indentaci√≥n.
            Evita mezclar tabulaciones con espacios.
          </div>
        </div>

        <!-- ========================================================= -->
        <!-- 2) BLOQUES + EJEMPLOS CLAVE -->
        <!-- ========================================================= -->
        <h4 class="fw-bold mt-5 mb-3" id="bloques">¬øQu√© crea un bloque en Python?</h4>
        <p class="text-muted">
          Normalmente un bloque empieza cuando una l√≠nea termina con <code>:</code> (dos puntos).
          Ejemplos t√≠picos: <code>if</code>, <code>for</code>, <code>while</code>, <code>def</code>, <code>class</code>, <code>try</code>.
        </p>

        <div class="row g-3">
          <div class="col-md-6">
            <div class="card border-0 shadow-sm h-100">
              <div class="card-header bg-primary text-white fw-bold">Ejemplo: condicional</div>
              <div class="card-body bg-light font-monospace">
                edad = 18<br><br>
                if edad &gt;= 18:<br>
                &nbsp;&nbsp;&nbsp;&nbsp;print("Puedes votar")<br>
                else:<br>
                &nbsp;&nbsp;&nbsp;&nbsp;print("A√∫n no")
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="card border-0 shadow-sm h-100">
              <div class="card-header bg-dark text-white fw-bold">Ejemplo: bucle</div>
              <div class="card-body bg-light font-monospace">
                for i in range(3):<br>
                &nbsp;&nbsp;&nbsp;&nbsp;print("Vuelta:", i)<br><br>
                print("Fin del bucle")
              </div>
            </div>
          </div>
        </div>

        <!-- ========================================================= -->
        <!-- 3) ERRORES COMUNES DE SINTAXIS -->
        <!-- ========================================================= -->
        <h4 class="fw-bold mt-5 mb-3" id="errores-comunes">Errores comunes (y c√≥mo evitarlos)</h4>

        <div class="accordion" id="accErrores">
          <div class="accordion-item">
            <h2 class="accordion-header" id="h1">
              <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#c1" aria-expanded="true" aria-controls="c1">
                1) Olvidar los dos puntos <code>:</code>
              </button>
            </h2>
            <div id="c1" class="accordion-collapse collapse show" aria-labelledby="h1" data-bs-parent="#accErrores">
              <div class="accordion-body">
                <div class="bg-light p-3 rounded font-monospace">
                  if 10 &gt; 5<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;print("ok")
                </div>
                <div class="mt-2 text-muted">
                  Debe ser <code>if 10 &gt; 5:</code>. Sin <code>:</code> Python no inicia el bloque.
                </div>
              </div>
            </div>
          </div>

          <div class="accordion-item">
            <h2 class="accordion-header" id="h2">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#c2" aria-expanded="false" aria-controls="c2">
                2) Mezclar tabs y espacios
              </button>
            </h2>
            <div id="c2" class="accordion-collapse collapse" aria-labelledby="h2" data-bs-parent="#accErrores">
              <div class="accordion-body">
                <p class="mb-2">
                  Si unes tabulaciones y espacios, puede salir:
                  <code>TabError: inconsistent use of tabs and spaces</code>.
                </p>
                <ul class="mb-0">
                  <li>Configura tu editor para insertar 4 espacios al presionar TAB.</li>
                  <li>En VS Code: ‚ÄúConvert Indentation to Spaces‚Äù.</li>
                </ul>
              </div>
            </div>
          </div>

          <div class="accordion-item">
            <h2 class="accordion-header" id="h3">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#c3" aria-expanded="false" aria-controls="c3">
                3) Indentar donde no va
              </button>
            </h2>
            <div id="c3" class="accordion-collapse collapse" aria-labelledby="h3" data-bs-parent="#accErrores">
              <div class="accordion-body">
                <div class="bg-light p-3 rounded font-monospace">
                  &nbsp;&nbsp;print("Hola")
                </div>
                <p class="mt-2 mb-0 text-muted">
                  Si indentas una l√≠nea sin haber abierto un bloque antes, puede salir:
                  <code>IndentationError: unexpected indent</code>.
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- ========================================================= -->
        <!-- 4) COMENTARIOS EN PYTHON -->
        <!-- ========================================================= -->
        <h3 class="fw-bold mt-5 mb-3" id="comentarios-python">Comentarios en Python</h3>
        <p>
          Los comentarios son ignorados por el int√©rprete y sirven para documentar tu c√≥digo
          (qu√© hace, por qu√© lo hace y qu√© entrada/salida espera). :contentReference[oaicite:1]{index=1}
        </p>

        <div class="row g-3">
          <div class="col-md-6">
            <div class="card border-0 shadow-sm h-100">
              <div class="card-header bg-primary text-white fw-bold">1) Comentario de una l√≠nea</div>
              <div class="card-body bg-light font-monospace text-muted">
                # Esto es un comentario<br>
                print("Hola")  # Esto tambi√©n
              </div>
              <div class="card-footer small text-muted">
                Ideal para explicar una l√≠nea o decisi√≥n r√°pida.
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="card border-0 shadow-sm h-100">
              <div class="card-header bg-success text-white fw-bold">2) Docstring (multil√≠nea)</div>
              <div class="card-body bg-light font-monospace text-muted">
                """<br>
                Describe una funci√≥n o m√≥dulo.<br>
                Sirve para documentaci√≥n.<br>
                """
              </div>
              <div class="card-footer small text-muted">
                Se usa mucho en funciones, clases y m√≥dulos.
              </div>
            </div>
          </div>
        </div>

        <div class="alert alert-info mt-4 d-flex align-items-center">
          <i class="bi bi-lightbulb-fill me-2"></i>
          <div>
            <strong>Tip pr√°ctico:</strong> Un comentario bueno explica el ‚Äúpor qu√©‚Äù, no lo obvio.
            Mejor: <em>‚ÄúSe valida para evitar datos vac√≠os‚Äù</em> que <em>‚ÄúSe valida un if‚Äù</em>.
          </div>
        </div>

        <!-- ========================================================= -->
        <!-- 5) COMENTARIOS EN HTML -->
        <!-- ========================================================= -->
        <h3 class="fw-bold mt-5 mb-3" id="comentarios-html">Comentarios en HTML</h3>
        <p class="text-muted">
          En HTML los comentarios se escriben as√≠ y no se muestran en la p√°gina: :contentReference[oaicite:2]{index=2}
        </p>

        <div class="bg-light border rounded p-3 font-monospace">
          &lt;!-- Este es un comentario en HTML --&gt;<br>
          &lt;h1&gt;Contenido visible&lt;/h1&gt;
        </div>

        <div class="row g-3 mt-2">
          <div class="col-md-6">
            <div class="card border-0 shadow-sm h-100">
              <div class="card-header bg-dark text-white fw-bold">¬øPara qu√© sirve?</div>
              <div class="card-body">
                <ul class="mb-0">
                  <li>Marcar secciones del documento</li>
                  <li>Explicar estructura o componentes</li>
                  <li>Dejar notas para tu equipo</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card border-0 shadow-sm h-100">
              <div class="card-header bg-warning fw-bold">Cuidado</div>
              <div class="card-body">
                <ul class="mb-0">
                  <li>No pongas contrase√±as o datos sensibles</li>
                  <li>El navegador no lo muestra, pero cualquiera puede verlo en ‚ÄúVer c√≥digo fuente‚Äù</li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <!-- ========================================================= -->
        <!-- 6) TABLA COMPARATIVA -->
        <!-- ========================================================= -->
        <h3 class="fw-bold mt-5 mb-3" id="comparacion">Comparaci√≥n r√°pida</h3>

        <div class="table-responsive">
          <table class="table table-bordered align-middle">
            <thead class="table-light">
              <tr>
                <th style="width:35%;">Tema</th>
                <th style="width:32%;">Python</th>
                <th>HTML</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Bloques</strong></td>
                <td>Se definen por <strong>indentaci√≥n</strong></td>
                <td>Se definen por <strong>etiquetas</strong></td>
              </tr>
              <tr>
                <td><strong>Comentarios</strong></td>
                <td><code>#</code> y <code>""" """</code></td>
                <td><code>&lt;!-- --&gt;</code></td>
              </tr>
              <tr>
                <td><strong>Objetivo</strong></td>
                <td>L√≥gica / reglas del sistema</td>
                <td>Estructura / presentaci√≥n</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- ========================================================= -->
        <!-- 7) QUIZ INTERACTIVO -->
        <!-- ========================================================= -->
        <h3 class="fw-bold mt-5 mb-4 text-center" id="quiz-sintaxis">
          üß† Cuestionario ‚Äì Sintaxis e indentaci√≥n
        </h3>
        <p class="text-muted text-center mb-4">
          Responde para avanzar. Cada pregunta solo puede responderse una vez.
        </p>

        <style>
          .quiz-card-sin {
            background: linear-gradient(135deg, #f8fafc, #ffffff);
            border-radius: 1.2rem;
            box-shadow: 0 12px 30px rgba(0,0,0,0.1);
            padding: 2rem;
            max-width: 720px;
            margin: auto;
          }
          .quiz-option-sin {
            width: 100%;
            text-align: left;
            margin-bottom: 0.6rem;
          }
          .quiz-option-sin.correct { background-color: #22c55e !important; color: #fff; }
          .quiz-option-sin.wrong   { background-color: #ef4444 !important; color: #fff; }
          .quiz-progress-sin { font-size: 0.9rem; color: #555; }
        </style>

        <div class="quiz-card-sin">
          <div class="quiz-progress-sin mb-2">
            Pregunta <span id="numPreguntaSin"></span> de <span id="totalPreguntasSin"></span>
          </div>

          <h5 class="fw-bold mb-3" id="preguntaTituloSin"></h5>
          <div id="opcionesSin"></div>

          <div id="feedbackSin" class="alert d-none mt-3"></div>
          <div id="solucionSin" class="alert alert-info d-none mt-2"></div>

          <div class="text-end mt-3">
            <button id="btnSiguienteSin" class="btn btn-primary d-none" onclick="siguientePreguntaSin()">
              Siguiente ‚Üí
            </button>
          </div>
        </div>

        <script>
          const preguntasSin = [
            {
              titulo: "¬øQu√© define un bloque de c√≥digo en Python?",
              opciones: [
                { texto: "Llaves { }", correcta: false },
                { texto: "Indentaci√≥n (sangr√≠a)", correcta: true },
                { texto: "Puntos y comas ;", correcta: false }
              ],
              solucion: "En Python los bloques se definen por indentaci√≥n. No se usan llaves."
            },
            {
              titulo: "¬øQu√© error aparece si falta indentaci√≥n dentro de un if?",
              opciones: [
                { texto: "IndentationError", correcta: true },
                { texto: "NameError", correcta: false },
                { texto: "TypeError", correcta: false }
              ],
              solucion: "Si falta la sangr√≠a en un bloque, Python lanza IndentationError."
            },
            {
              titulo: "¬øC√≥mo se escribe un comentario de una l√≠nea en Python?",
              opciones: [
                { texto: "// comentario", correcta: false },
                { texto: "# comentario", correcta: true },
                { texto: "<!-- comentario -->", correcta: false }
              ],
              solucion: "En Python, el comentario de una l√≠nea se hace con #."
            },
            {
              titulo: "¬øC√≥mo se escribe un comentario en HTML?",
              opciones: [
                { texto: "# comentario", correcta: false },
                { texto: "<!-- comentario -->", correcta: true },
                { texto: "/* comentario */", correcta: false }
              ],
              solucion: "En HTML se usan comentarios con {{ '<!-- ... -->' }}."
            },
            {
              titulo: "¬øCu√°l es el uso correcto de docstrings en Python?",
              opciones: [
                { texto: "Documentar funciones, clases o m√≥dulos", correcta: true },
                { texto: "Reemplazar siempre todos los comentarios", correcta: false }
              ],
              solucion: "Los docstrings (\"\"\" \"\"\") describen funciones/clases/m√≥dulos y sirven para documentaci√≥n."
            }
          ];

          let indiceSin = 0;
          let puntajeSin = 0;
          let respondidaSin = false;

          function cargarPreguntaSin() {
            respondidaSin = false;
            document.getElementById("feedbackSin").classList.add("d-none");
            document.getElementById("solucionSin").classList.add("d-none");
            document.getElementById("btnSiguienteSin").classList.add("d-none");

            const p = preguntasSin[indiceSin];
            document.getElementById("preguntaTituloSin").textContent = p.titulo;
            document.getElementById("numPreguntaSin").textContent = indiceSin + 1;
            document.getElementById("totalPreguntasSin").textContent = preguntasSin.length;

            const cont = document.getElementById("opcionesSin");
            cont.innerHTML = "";

            p.opciones.forEach(op => {
              const b = document.createElement("button");
              b.className = "btn btn-outline-primary quiz-option-sin";
              b.textContent = op.texto;
              b.onclick = () => responderSin(b, op.correcta, p.solucion);
              cont.appendChild(b);
            });
          }

          function responderSin(btn, correcta, solucion) {
            if (respondidaSin) return;
            respondidaSin = true;

            const feedback = document.getElementById("feedbackSin");
            const solucionDiv = document.getElementById("solucionSin");

            document.querySelectorAll(".quiz-option-sin").forEach(b => b.disabled = true);

            if (correcta) {
              puntajeSin++;
              btn.classList.add("correct");
              feedback.className = "alert alert-success mt-3";
              feedback.textContent = "‚úîÔ∏è Respuesta correcta.";
            } else {
              btn.classList.add("wrong");
              feedback.className = "alert alert-warning mt-3";
              feedback.textContent = "‚ùå Respuesta incorrecta.";
              solucionDiv.textContent = solucion;
              solucionDiv.classList.remove("d-none");
            }

            feedback.classList.remove("d-none");
            document.getElementById("btnSiguienteSin").classList.remove("d-none");
          }

          function siguientePreguntaSin() {
            indiceSin++;
            if (indiceSin < preguntasSin.length) {
              cargarPreguntaSin();
            } else {
              mostrarResultadoSin();
            }
          }

          function mostrarResultadoSin() {
            const nota = Math.round((puntajeSin / preguntasSin.length) * 10);

            document.querySelector(".quiz-card-sin").innerHTML = `
              <div class="text-center">
                <h4 class="fw-bold mb-3">üìä Resultado Final</h4>
                <div class="display-4 fw-bold text-primary mb-2">${nota}/10</div>
                <p class="text-muted">Correctas: ${puntajeSin} de ${preguntasSin.length}</p>
                <div class="alert ${nota >= 7 ? 'alert-success' : 'alert-warning'} mt-4">
                  ${nota >= 7
                    ? 'üéâ Excelente. Ya dominas indentaci√≥n y comentarios.'
                    : 'üìò Revisa los ejemplos y vuelve a intentarlo.'}
                </div>
                <button class="btn btn-outline-primary mt-3" onclick="reiniciarQuizSin()">
                  üîÅ Reintentar
                </button>
              </div>
            `;
          }

          function reiniciarQuizSin() {
            indiceSin = 0;
            puntajeSin = 0;
            location.reload();
          }

          cargarPreguntaSin();
        </script>

        <!-- ========================================================= -->
        <!-- 8) MINI-JUEGO: ARMA EL C√ìDIGO -->
        <!-- ========================================================= -->
        <h3 class="fw-bold mt-5 mb-4 text-center" id="mini-juego-sintaxis">
          üéÆ Mini-juego: arma el c√≥digo con indentaci√≥n correcta
        </h3>
        <p class="text-muted text-center mb-4">
          Arrastra las l√≠neas para formar un programa v√°lido. Luego presiona ‚ÄúVerificar‚Äù.
        </p>

        <style>
          .game-sin { max-width: 900px; margin: auto; }
          .pool-sin, .slot-sin {
            background: #f8fafc;
            border-radius: 1rem;
            padding: 1.2rem;
            box-shadow: 0 8px 22px rgba(0,0,0,0.08);
            min-height: 120px;
          }
          .line-sin {
            background: #fff;
            border-radius: 0.9rem;
            padding: 0.8rem 1rem;
            margin-bottom: 0.6rem;
            cursor: grab;
            box-shadow: 0 5px 14px rgba(0,0,0,0.12);
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            font-size: 0.95rem;
          }
          .line-sin:active { cursor: grabbing; transform: scale(1.02); }
          .target-sin {
            border: 2px dashed #2563eb;
            border-radius: 0.9rem;
            padding: 1rem;
            background: #fff;
            min-height: 180px;
          }
          .ok-sin { background: #dcfce7 !important; border-color: #22c55e !important; }
          .bad-sin { background: #fee2e2 !important; border-color: #ef4444 !important; }
        </style>

        <div class="game-sin">
          <div class="row g-3">
            <div class="col-md-6">
              <h6 class="fw-bold mb-2">üß© L√≠neas disponibles</h6>
              <div class="pool-sin" id="poolSin">
                <div class="line-sin" draggable="true" data-line="1">if 5 &gt; 2:</div>
                <div class="line-sin" draggable="true" data-line="2">&nbsp;&nbsp;&nbsp;&nbsp;print("Ok")</div>
                <div class="line-sin" draggable="true" data-line="3">print("Fin")</div>
              </div>
            </div>

            <div class="col-md-6">
              <h6 class="fw-bold mb-2">üß† Tu programa</h6>
              <div class="target-sin" id="targetSin"></div>

              <div class="text-center mt-3">
                <button class="btn btn-primary me-2" onclick="verificarSin()">‚úÖ Verificar</button>
                <button class="btn btn-outline-secondary" onclick="reiniciarSin()">üîÅ Reiniciar</button>
              </div>

              <div id="resultadoSin" class="alert d-none mt-3 text-center"></div>
            </div>
          </div>
        </div>

        <script>
          let draggedSin = null;

          document.querySelectorAll(".line-sin").forEach(line => {
            line.addEventListener("dragstart", () => { draggedSin = line; });
          });

          const targetSin = document.getElementById("targetSin");
          const poolSin = document.getElementById("poolSin");

          targetSin.addEventListener("dragover", e => e.preventDefault());
          poolSin.addEventListener("dragover", e => e.preventDefault());

          targetSin.addEventListener("drop", () => {
            if (draggedSin) targetSin.appendChild(draggedSin);
          });

          poolSin.addEventListener("drop", () => {
            if (draggedSin) poolSin.appendChild(draggedSin);
          });

          function verificarSin() {
            const lines = Array.from(targetSin.querySelectorAll(".line-sin")).map(x => x.dataset.line);
            const correcto = (lines.join(",") === "1,2,3");

            targetSin.classList.remove("ok-sin", "bad-sin");
            const r = document.getElementById("resultadoSin");
            r.classList.remove("d-none");

            if (correcto) {
              targetSin.classList.add("ok-sin");
              r.className = "alert alert-success mt-3 text-center";
              r.textContent = "üéâ ¬°Perfecto! Tu indentaci√≥n est√° correcta.";
            } else {
              targetSin.classList.add("bad-sin");
              r.className = "alert alert-warning mt-3 text-center";
              r.textContent = "‚ùå A√∫n no. Recuerda: la l√≠nea dentro del if debe ir indentada.";
            }
          }

          function reiniciarSin() {
            Array.from(targetSin.querySelectorAll(".line-sin")).forEach(x => poolSin.appendChild(x));
            targetSin.classList.remove("ok-sin", "bad-sin");
            document.getElementById("resultadoSin").classList.add("d-none");
          }
        </script>

        <!-- ========================================================= -->
        <!-- NAV BTNS -->
        <!-- ========================================================= -->
        <div class="d-flex justify-content-between mt-5 pt-4 border-top">
          <a href="{{ url_for('teoria_tema', slug='html-python-web') }}" class="btn btn-outline-secondary rounded-pill px-4">
            <i class="bi bi-arrow-left me-2"></i> Anterior
          </a>
          <a href="{{ url_for('teoria_tema', slug='variables-constantes') }}" class="btn btn-primary rounded-pill px-4">
            Siguiente: Variables <i class="bi bi-arrow-right ms-2"></i>
          </a>
        </div>

      </div>
    </div>
  </div>
</section>
{% endblock %}
